---
title: "ERA 5 Gap Filling quality Assessment"
output: html_notebook
---

```{r}
library(tidyverse)
theme_set(theme_bw())
library(Metrics)
library(lubridate)
library(xfun)
# parallel execution
library(furrr)
n_workers <- 11
plan(multisession, workers = n_workers)

# number repetition for each gap
n_rep <-  10

#load_all() doesn't works with futures, so loading only code in R dir
list.files(here::here("R"), full.names = TRUE) %>%
  walk(source)
```

```{r}
hai_era_path <- here::here("data/FLX_DE-Hai_FLUXNET2015_ERAI_HH_1989-2014_1-4.csv")
hai_path <- here::here("data/FLX_DE-Hai_FLUXNET2015_FULLSET_HH_2000-2012_1-4.csv")
hai_raw <- read_csv(hai_path, col_types = cols(TIMESTAMP_START = col_datetime(format="%Y%m%d%H%M"), TIMESTAMP_END = col_datetime(format="%Y%m%d%H%M")), na = c("-9999", "-9999.99"))
hai_era_raw <- read_csv(hai_era_path, col_types = cols(TIMESTAMP_START = col_datetime(format="%Y%m%d%H%M"), TIMESTAMP_END = col_datetime(format="%Y%m%d%H%M")), na = c("-9999", "-9999.99"))
```
```{r}
read_csv(hai_era_path, n_max = 100)
```
